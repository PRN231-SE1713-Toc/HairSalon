@page
@model HairSalon.Web.Pages.Login.LoginModel
@{
}

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Login/Register Form</title>
    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/css/bootstrap.min.css">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.5.0/font/bootstrap-icons.css">
    <link rel="stylesheet" href="~/css/site.css">

    <style>

    </style>

</head>
<body>
    <div class="container-login">
        <div class="row justify-content-center align-items-center min-vh-100">
            <div class="col-md-6">
                <div class="card shadow">
                    <div class="card-body">
                        <ul class="nav nav-tabs" id="myTab" role="tablist">
                            <li class="nav-item">
                                <a class="nav-link active" id="login-tab" data-toggle="tab" href="#login" role="tab" aria-controls="login" aria-selected="true">Login</a>
                            </li>
                            <li class="nav-item">
                                <a class="nav-link" id="register-tab" data-toggle="tab" href="#register" role="tab" aria-controls="register" aria-selected="false">Register</a>
                            </li>
                        </ul>
                        <div class="tab-content mt-3" id="myTabContent">
                            <!-- Login form -->
                            <div class="tab-pane fade show active" id="login" role="tabpanel" aria-labelledby="login-tab">
                                <form id="loginForm">
                                    <div class="form-group">
                                        <label for="loginEmail">Email address</label>
                                        <input type="email" class="form-control" id="loginEmail" required aria-describedby="loginEmailFeedback">
                                        <div id="loginEmailFeedback" class="invalid-feedback"></div>
                                    </div>
                                    <div class="form-group">
                                        <label for="loginPassword">Password</label>
                                        <div class="input-group">
                                            <input type="password" class="form-control" id="loginPassword" required aria-describedby="loginPasswordFeedback">
                                            <div class="input-group-append">
                                                <button class="btn btn-outline-secondary" type="button" id="loginTogglePassword">
                                                    <i class="bi bi-eye"></i>
                                                </button>
                                            </div>
                                        </div>
                                        <div id="loginPasswordFeedback" class="invalid-feedback"></div>
                                    </div>
                                    <button type="submit" class="btn btn-primary btn-block" id="loginSubmit">Login</button>
                                </form>
                            </div>

                            <!-- Register form -->
                            <div class="tab-pane fade" id="register" role="tabpanel" aria-labelledby="register-tab">
                                <form id="registerForm">
                                    <div class="form-group">
                                        <label for="registerName">Name</label>
                                        <input type="text" class="form-control" id="registerName" required>
                                    </div>
                                    <div class="form-group">
                                        <label for="registerEmail">Email address</label>
                                        <input type="email" class="form-control" id="registerEmail" required aria-describedby="registerEmailFeedback">
                                        <div id="registerEmailFeedback" class="invalid-feedback"></div>
                                    </div>
                                    <div class="form-group">
                                        <label for="registerPassword">Password</label>
                                        <div class="input-group">
                                            <input type="password" class="form-control" id="registerPassword" required aria-describedby="registerPasswordFeedback">
                                            <div class="input-group-append">
                                                <button class="btn btn-outline-secondary" type="button" id="registerTogglePassword">
                                                    <i class="bi bi-eye"></i>
                                                </button>
                                            </div>
                                        </div>
                                        <div id="registerPasswordFeedback" class="invalid-feedback"></div>
                                    </div>
                                    <div class="form-group">
                                        <label for="confirmPassword">Confirm Password</label>
                                        <div class="input-group">
                                            <input type="password" class="form-control" id="confirmPassword" required aria-describedby="confirmPasswordFeedback">
                                            <div class="input-group-append">
                                                <button class="btn btn-outline-secondary" type="button" id="confirmTogglePassword">
                                                    <i class="bi bi-eye"></i>
                                                </button>
                                            </div>
                                        </div>
                                        <div id="confirmPasswordFeedback" class="invalid-feedback"></div>
                                    </div>
                                    <button type="submit" class="btn btn-primary btn-block" id="registerSubmit">Register</button>
                                </form>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Scripts -->
    <script src="https://code.jquery.com/jquery-3.5.1.slim.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/popper.js@1.16.1/dist/umd/popper.min.js"></script>
    <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/js/bootstrap.min.js"></script>
    <script>
    $(document).ready(function () {
        // Email validation function
        function validateEmail(email) {
            const re = /^[a-zA-Z0-9._-]+@@[a-zA-Z0-9.-]+\.[a-zA-Z]{2,4}$/;
            return re.test(email);
        }

        // Password validation function
        function validatePassword(password) {
            return password.length >= 8;
        }

        // Email input validation
        $('input[type="email"]').on('input', function () {
            const email = $(this).val();
            const feedbackId = $(this).attr('aria-describedby');
            if (!validateEmail(email)) {
                $(this).addClass('is-invalid');
                $(`#${feedbackId}`).text('Invalid email format').show();
            } else {
                $(this).removeClass('is-invalid');
                $(`#${feedbackId}`).hide();
            }
        });

        // Password input validation
        $('input[type="password"]').on('input', function () {
            const password = $(this).val();
            const feedbackId = $(this).attr('aria-describedby');
            if (!validatePassword(password)) {
                $(this).addClass('is-invalid');
                $(`#${feedbackId}`).text('Password must be at least 8 characters long').show();
            } else {
                $(this).removeClass('is-invalid');
                $(`#${feedbackId}`).hide();
            }
        });

        // Toggle password visibility
        $('.btn-outline-secondary').on('click', function () {
            const passwordInput = $(this).closest('.input-group').find('input');
            const icon = $(this).find('i');
            if (passwordInput.attr('type') === 'password') {
                passwordInput.attr('type', 'text');
                icon.removeClass('bi-eye').addClass('bi-eye-slash');
            } else {
                passwordInput.attr('type', 'password');
                icon.removeClass('bi-eye-slash').addClass('bi-eye');
            }
        });

        // Form submission handling
        $('form').on('submit', function (e) {
            e.preventDefault();
            const isFormValid = $('input.is-invalid').length === 0;

            if (!isFormValid) {
                return; // Stop form submission if there are invalid fields
            }

            const submitBtn = $(this).find('button[type="submit"]');
            submitBtn.html('<span class="spinner-border spinner-border-sm" role="status" aria-hidden="true"></span> Loading...');

            // Simulate form submission delay (e.g., AJAX or form validation process)
            setTimeout(() => {
                submitBtn.html(submitBtn.attr('id') === 'loginSubmit' ? 'Login' : 'Register');
                // Optionally submit the form using AJAX or another method
            }, 2000);
        });
    });
    </script>
</body>
